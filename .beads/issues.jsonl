{"id":"banana-appeal-0sw","title":"edit_image silently leaves original when extension corrected","description":"When output_path=None and Gemini returns a different format, edit_image saves to corrected extension (e.g., .jpg instead of .png) but leaves the original file untouched. This silently changes behavior from 'overwrite original'. Consider deleting/renaming original on correction or documenting this explicitly.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-12T17:02:09.130066-08:00","updated_at":"2025-12-15T07:55:39.332646-08:00","closed_at":"2025-12-15T07:55:39.332646-08:00"}
{"id":"banana-appeal-2bw","title":"Update generate_image with structured response","description":"Modify generate_image to return structured response when saving.\n\n**Files:**\n- Modify: src/banana_appeal/server.py\n- Test: tests/test_server.py\n\n**Changes to _generate_image_impl:**\n- Add verbose: bool = False parameter\n- Track generation_time_ms with time.perf_counter()\n- Call _correct_extension before saving\n- Build ImageOperationResponse instead of ImageResult.from_saved\n- Call _add_verbose_fields if verbose=True\n- Return ImageOperationResponse for saved, ImageResult for inline\n\n**Changes to generate_image MCP wrapper:**\n- Add verbose parameter with Field description\n- Change return type to Image | dict\n- Call result.model_dump(exclude_none=True) for structured response\n\n**Tests:**\n- test_returns_dict_when_saving\n- test_extension_correction_in_response\n- test_verbose_adds_metadata\n- test_verbose_false_excludes_metadata\n\n**TDD:** Write tests first, implement, commit.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-10T15:06:24.209452-08:00","updated_at":"2025-12-10T16:30:06.407862-08:00","closed_at":"2025-12-10T16:30:06.407862-08:00","dependencies":[{"issue_id":"banana-appeal-2bw","depends_on_id":"banana-appeal-vnj","type":"blocks","created_at":"2025-12-10T15:06:42.825046-08:00","created_by":"daemon"},{"issue_id":"banana-appeal-2bw","depends_on_id":"banana-appeal-tfs","type":"blocks","created_at":"2025-12-10T15:06:42.854387-08:00","created_by":"daemon"}]}
{"id":"banana-appeal-2dx","title":"Set up semantic release and PyPI publishing","description":"Automate versioning and PyPI publishing based on conventional commits.\n\n## Scope\n- Configure python-semantic-release for automatic version bumping\n- Add GitHub Actions workflow triggered on main branch merges\n- Set up PyPI trusted publishing (OIDC) instead of API tokens\n- Ensure conventional commit messages drive version increments (feat→minor, fix→patch, breaking→major)\n\n## Notes\n- Project already uses conventional commits per AGENTS.md\n- Build job already validates package with twine check","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-15T11:26:44.169424-08:00","updated_at":"2025-12-15T11:26:44.169424-08:00"}
{"id":"banana-appeal-2za","title":"Run full test suite and fix issues","description":"Run complete test suite, linting, and type checking. Fix any issues.\n\n**Commands:**\n```bash\nuv run pytest -v\nuv run ruff check .\nuv run ruff format .\nuv run pyrefly check src/banana_appeal/\n```\n\n**Fix any failures or linting errors found.**","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-10T15:06:24.826618-08:00","updated_at":"2025-12-10T16:37:28.919379-08:00","closed_at":"2025-12-10T16:37:28.919379-08:00","dependencies":[{"issue_id":"banana-appeal-2za","depends_on_id":"banana-appeal-2bw","type":"blocks","created_at":"2025-12-10T15:06:43.437139-08:00","created_by":"daemon"},{"issue_id":"banana-appeal-2za","depends_on_id":"banana-appeal-ug0","type":"blocks","created_at":"2025-12-10T15:06:43.464439-08:00","created_by":"daemon"},{"issue_id":"banana-appeal-2za","depends_on_id":"banana-appeal-xd9","type":"blocks","created_at":"2025-12-10T15:06:43.493344-08:00","created_by":"daemon"}]}
{"id":"banana-appeal-3bj","title":"Fix generation timing in blend_images includes image loading","description":"start_time is set before image loading at line 604, not right before API call like other tools. This inflates timing to include file I/O instead of just API call time.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-11T11:46:30.165757-08:00","updated_at":"2025-12-11T11:47:07.375711-08:00","closed_at":"2025-12-11T11:47:07.375711-08:00"}
{"id":"banana-appeal-4wc","title":"Update documentation for structured responses","description":"Document the new structured response format and verbose parameter.\n\n**Update README.md or docs/ with:**\n- New response format examples\n- verbose parameter usage\n- Extension auto-correction behavior\n- Example responses (default vs verbose)\n\n**Keep it brief - focus on usage examples.**","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-10T15:06:25.033069-08:00","updated_at":"2025-12-10T16:38:04.360119-08:00","closed_at":"2025-12-10T16:38:04.360119-08:00","dependencies":[{"issue_id":"banana-appeal-4wc","depends_on_id":"banana-appeal-2za","type":"blocks","created_at":"2025-12-10T15:06:43.675744-08:00","created_by":"daemon"}]}
{"id":"banana-appeal-56u","title":"Simplify _correct_extension by extracting canonical extension logic","description":"The _correct_extension function has duplicate logic for determining new_ext (lines 199 and 209). Extract the canonical extension derivation into a single expression at the start. Estimated reduction: ~20 lines to ~16 lines.","status":"open","priority":3,"issue_type":"chore","created_at":"2025-12-15T10:56:53.559958-08:00","updated_at":"2025-12-15T10:56:53.559958-08:00"}
{"id":"banana-appeal-6xo","title":"Use resolved paths in edit_image extension correction comparison","description":"The comparison 'corrected_path \\!= request.image_path' compares Path objects directly. Using .resolve() would be more robust against symlinks or unusual path representations. Low priority since both paths come from the same base path in practice.","status":"open","priority":4,"issue_type":"task","created_at":"2025-12-15T06:25:22.725132-08:00","updated_at":"2025-12-15T06:25:22.725132-08:00"}
{"id":"banana-appeal-7f0","title":"Test auto-commit","description":"","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T13:57:27.123368-08:00","updated_at":"2025-12-06T14:01:17.404246-08:00","closed_at":"2025-12-06T14:01:17.404246-08:00"}
{"id":"banana-appeal-7gl","title":"Add upscale_image tool","description":"The Gemini API supports image upscaling via the UpscaleImageConfig. Add a new upscale_image tool that takes an image path and upscale factor (2x, 4x, 8x) and returns an enhanced, higher-resolution version.","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-06T15:29:57.97317-08:00","updated_at":"2025-12-06T15:29:57.97317-08:00"}
{"id":"banana-appeal-8d9","title":"Add ImageDimensions model","description":"Add ImageDimensions Pydantic model to models.py for typed width/height.\n\n**Files:**\n- Modify: src/banana_appeal/models.py (add after ImageFormat class, ~line 28)\n- Test: tests/test_models.py\n\n**Implementation:**\n```python\nclass ImageDimensions(BaseModel):\n    \"\"\"Image dimensions in pixels.\"\"\"\n    model_config = ConfigDict(frozen=True)\n    width: int = Field(gt=0, description=\"Image width in pixels\")\n    height: int = Field(gt=0, description=\"Image height in pixels\")\n```\n\n**Tests:**\n- test_create_dimensions: Create valid dimensions\n- test_dimensions_immutable: Verify frozen model\n\n**TDD:** Write tests first, verify they fail, implement, verify pass, commit.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-10T15:06:23.420589-08:00","updated_at":"2025-12-10T15:16:16.696272-08:00","closed_at":"2025-12-10T15:16:16.696272-08:00"}
{"id":"banana-appeal-94w","title":"Add Google Search grounding option for Gemini 3 Pro","description":"Gemini 3 Pro Image supports Google Search grounding, which allows generating images with real-time, fact-verified information (e.g., current weather visualizations). Add an optional use_search parameter that enables tools=[{'google_search': {}}] in the config. Only works with gemini-3-pro-image-preview model.","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-06T15:29:48.091783-08:00","updated_at":"2025-12-06T15:29:48.091783-08:00"}
{"id":"banana-appeal-9fr","title":"blend_images has nondeterministic image order","description":"blend_images loads images concurrently and appends to shared list as tasks complete, making order nondeterministic. Gemini blends are order-sensitive. Should preserve user-specified order by preallocating list and assigning by index.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-12T17:02:09.532962-08:00","updated_at":"2025-12-12T17:02:09.532962-08:00"}
{"id":"banana-appeal-a08","title":"verbose=True silently ignored for inline responses","description":"verbose=True is accepted when no save_path/output_path provided, but inline Image responses drop all verbose metadata. This silently ignores the flag. Consider rejecting verbose when not saving, or returning structured metadata alongside inline image.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-12T17:02:09.733435-08:00","updated_at":"2025-12-12T17:02:09.733435-08:00"}
{"id":"banana-appeal-axu","title":"Catch Pillow decode errors in verbose mode","description":"When verbose=True, _add_verbose_fields opens image bytes with Pillow to get dimensions. If Pillow fails (corrupt/unsupported), the MCP call aborts even though the image was already saved. Should catch decode errors and return base ImageOperationResponse with a warning instead.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-12T17:02:08.941957-08:00","updated_at":"2025-12-15T06:11:01.112662-08:00","closed_at":"2025-12-15T06:11:01.112662-08:00"}
{"id":"banana-appeal-b1l","title":"Handle image/jpg MIME alias in _extract_image_data","description":"_extract_image_data maps unknown MIME types to PNG. The common alias 'image/jpg' fails ImageFormat('jpg') validation and falls back to PNG, causing JPEG bytes to be mislabeled. Add alias handling to treat image/jpg as JPEG.","status":"open","priority":2,"issue_type":"bug","created_at":"2025-12-12T17:02:09.323469-08:00","updated_at":"2025-12-12T17:02:09.323469-08:00"}
{"id":"banana-appeal-by3","title":"Add test for edit_image deletion failure scenario","description":"The edit_image function handles deletion failure gracefully (logs warning, continues), but there's no test verifying this behavior. If someone refactors this code, they might accidentally make deletion failure break the operation. Add a test that mocks AsyncPath.unlink to fail and verifies the operation still succeeds.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-15T06:25:22.409592-08:00","updated_at":"2025-12-15T06:25:22.409592-08:00"}
{"id":"banana-appeal-cb1","title":"Add per-call model selection to MCP tools","description":"Allow specifying model (Flash vs Pro) per tool call instead of only via BANANA_MODEL env var.\n\n**Use case:** Claude Code could automatically choose Flash for quick iterations and Pro for final high-quality diagrams/infographics.\n\n**Implementation:**\n1. Add optional 'model: str | None' parameter to GenerateImageRequest, EditImageRequest, BlendImagesRequest\n2. Pass model parameter through to Gemini API client initialization\n3. Update MCP tool definitions to expose the parameter\n4. Document that None/unspecified uses BANANA_MODEL default\n\n**Trade-offs:**\n- Pros: More flexible, optimize cost/quality per request\n- Cons: Adds complexity, could confuse which model is active","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-10T00:23:28.316342-08:00","updated_at":"2025-12-10T00:23:28.316342-08:00"}
{"id":"banana-appeal-cj6","title":"Add aspect ratio parameter to generate_image","description":"The Gemini API supports configurable aspect ratios (1:1, 2:3, 3:2, 3:4, 4:3, 4:5, 5:4, 9:16, 16:9, 21:9) via ImageConfig. Currently we hardcode response_modalities but don't expose aspect_ratio control. Add an optional aspect_ratio parameter to generate_image tool.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T15:29:47.799808-08:00","updated_at":"2025-12-07T11:55:19.41863-08:00","closed_at":"2025-12-07T11:55:19.41863-08:00"}
{"id":"banana-appeal-e2f","title":"Extract _build_image_response helper to reduce duplication","description":"The three implementation functions (_generate_image_impl, _edit_image_impl, _blend_images_impl) share nearly identical response-building logic for: extracting image data, calling _correct_extension, building ImageOperationResponse, and optionally calling _add_verbose_fields. Extract to a reusable helper. Estimated reduction: ~40 lines.","status":"open","priority":3,"issue_type":"chore","created_at":"2025-12-15T10:56:53.739983-08:00","updated_at":"2025-12-15T10:56:53.739983-08:00"}
{"id":"banana-appeal-ha2","title":"Track pytest-asyncio deprecation warning for Python 3.16","description":"The pytest-asyncio package uses 'asyncio.get_event_loop_policy' which is deprecated and slated for removal in Python 3.16. Monitor upstream for fix. Warning appears in plugin.py at lines 772, 874, 1216.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-06T13:24:12.052896-08:00","updated_at":"2025-12-06T13:24:12.052896-08:00"}
{"id":"banana-appeal-hft","title":"Update default model to gemini-2.5-flash-image","description":"Current default is gemini-2.0-flash-preview-image-generation. The gemini-2.5-flash-image model is newer and offers better performance. Consider also supporting gemini-3-pro-image-preview for advanced features (4K, text rendering, search grounding).","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-06T15:29:47.991953-08:00","updated_at":"2025-12-07T11:55:19.418013-08:00","closed_at":"2025-12-07T11:55:19.418013-08:00"}
{"id":"banana-appeal-izj","title":"Simplify _add_verbose_fields function","description":"Refactoring opportunity identified during code review: return ImageDimensions directly instead of tuple unpacking, shorten docstring, remove intermediate variables. Reduces function from 54 to 32 lines (41% reduction) with no behavior change.","status":"open","priority":2,"issue_type":"chore","created_at":"2025-12-15T06:11:01.281489-08:00","updated_at":"2025-12-15T06:11:01.281489-08:00"}
{"id":"banana-appeal-j92","title":"Add chat/multi-turn mode for iterative editing","description":"The Gemini cookbook recommends chat mode for iterative image editing as it maintains context through 'thought signatures'. This enables better character consistency and natural editing workflows. Consider adding a new tool or mode that maintains conversation state across multiple edit requests.","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-06T15:37:42.312259-08:00","updated_at":"2025-12-06T15:37:42.312259-08:00"}
{"id":"banana-appeal-jm8","title":"Add negative_prompt parameter for exclusions","description":"The Gemini API supports negative prompts to specify what should NOT appear in generated images. Add an optional negative_prompt parameter to generate_image to allow users to exclude unwanted elements.","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T15:29:57.794243-08:00","updated_at":"2025-12-07T11:55:23.784173-08:00","closed_at":"2025-12-07T11:55:23.784173-08:00"}
{"id":"banana-appeal-jmq","title":"Add seed parameter for reproducible generation","description":"The Gemini API supports a seed parameter for reproducible image generation. This is useful when iterating on a prompt - you can keep the same seed to see how prompt changes affect output while keeping other randomness constant. Add an optional seed parameter to generate_image.","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-06T15:29:57.883172-08:00","updated_at":"2025-12-07T11:55:19.419799-08:00","closed_at":"2025-12-07T11:55:19.419799-08:00"}
{"id":"banana-appeal-md3","title":"Add field selection for metadata responses","description":"Currently using verbose=True/False for metadata. Add finer-grained control like include=['dimensions', 'timing'] to let callers specify exactly which fields to return, minimizing token usage.\n\nDepends on: structured response implementation (in progress)\n\nExample API:\n```python\ngenerate_image(prompt='...', include=['dimensions', 'size_bytes'])\n```","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-10T14:41:11.179657-08:00","updated_at":"2025-12-10T14:41:11.179657-08:00"}
{"id":"banana-appeal-nkk","title":"Fix blend_images max limit based on model","description":"The blend_images tool currently allows up to 14 images regardless of model. However, gemini-2.5-flash-image (nano-banana) only supports 3 images max, while gemini-3-pro-image-preview supports 14 (6 high-fidelity). The limit should be model-aware, or we should document/warn users about this limitation.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-06T15:37:42.223061-08:00","updated_at":"2025-12-07T11:55:19.419447-08:00","closed_at":"2025-12-07T11:55:19.419447-08:00"}
{"id":"banana-appeal-ptx","title":"Add warning when edit_image original file deletion fails","description":"When edit_image extension correction triggers original file deletion but deletion fails, users only see the extension mismatch warning. They might be confused about why both files exist. Consider adding a warning like 'Note: original file at X could not be deleted' when deletion is attempted but fails.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-15T06:25:22.56801-08:00","updated_at":"2025-12-15T06:25:22.56801-08:00"}
{"id":"banana-appeal-qz3","title":"Fix original_path inconsistency in blend_images","description":"blend_images uses path comparison logic for original_path instead of warning-based logic like generate_image and edit_image. Should use: original_path=str(request.output_path) if warning else None","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-11T11:46:29.983221-08:00","updated_at":"2025-12-11T11:47:07.37343-08:00","closed_at":"2025-12-11T11:47:07.37343-08:00"}
{"id":"banana-appeal-rad","title":"Track google-genai deprecation warning for Python 3.17","description":"The google-genai package uses '_UnionGenericAlias' which is deprecated and slated for removal in Python 3.17. Monitor upstream for fix or find workaround. Warning: .venv/lib/python3.14/site-packages/google/genai/types.py:43","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-06T13:24:11.955382-08:00","updated_at":"2025-12-06T13:24:11.955382-08:00"}
{"id":"banana-appeal-tfs","title":"Add verbose fields helper function","description":"Add _add_verbose_fields async function to populate metadata.\n\n**Files:**\n- Modify: src/banana_appeal/server.py (add after _correct_extension)\n- Test: tests/test_server.py\n\n**Function signature:**\n```python\nasync def _add_verbose_fields(\n    response: ImageOperationResponse,\n    image_data: bytes,\n    generation_time_ms: float,\n    model_name: str,\n    seed: int | None,\n) -\u003e ImageOperationResponse:\n```\n\n**Implementation:**\n- Use PIL.Image.open(BytesIO(data)).size for dimensions (header only, fast)\n- Run in thread pool with to_thread.run_sync\n- Return new response with verbose fields populated\n\n**Tests:**\n- test_adds_dimensions\n- test_adds_size_bytes\n- test_adds_generation_time\n- test_adds_model_name\n- test_adds_seed_when_provided\n- test_preserves_base_fields\n\n**Also update imports:** Add ImageDimensions, ImageOperationResponse to imports from models.\n\n**TDD:** Write tests first, implement, commit.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-10T15:06:24.007976-08:00","updated_at":"2025-12-10T16:13:51.700367-08:00","closed_at":"2025-12-10T16:13:51.700367-08:00","dependencies":[{"issue_id":"banana-appeal-tfs","depends_on_id":"banana-appeal-zxx","type":"blocks","created_at":"2025-12-10T15:06:42.65363-08:00","created_by":"daemon"}]}
{"id":"banana-appeal-ug0","title":"Update edit_image with structured response","description":"Modify edit_image to return structured response.\n\n**Files:**\n- Modify: src/banana_appeal/server.py\n- Test: tests/test_server.py\n\n**Changes to _edit_image_impl:**\n- Add verbose: bool = False parameter\n- Track generation_time_ms\n- Call _correct_extension before saving\n- Return ImageOperationResponse (always saves, always structured)\n- Call _add_verbose_fields if verbose=True\n\n**Changes to edit_image MCP wrapper:**\n- Add verbose parameter\n- Change return type to dict (always structured)\n- Call result.model_dump(exclude_none=True)\n\n**Tests:**\n- test_returns_dict\n- test_extension_correction\n- test_verbose_mode\n\n**TDD:** Write tests first, implement, commit.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-10T15:06:24.407619-08:00","updated_at":"2025-12-10T16:36:17.056772-08:00","closed_at":"2025-12-10T16:36:17.056772-08:00","dependencies":[{"issue_id":"banana-appeal-ug0","depends_on_id":"banana-appeal-vnj","type":"blocks","created_at":"2025-12-10T15:06:43.029132-08:00","created_by":"daemon"},{"issue_id":"banana-appeal-ug0","depends_on_id":"banana-appeal-tfs","type":"blocks","created_at":"2025-12-10T15:06:43.061295-08:00","created_by":"daemon"}]}
{"id":"banana-appeal-vnj","title":"Add extension correction function","description":"Add _correct_extension function to server.py for auto-correcting file extensions.\n\n**Files:**\n- Modify: src/banana_appeal/server.py (add after _log_metrics, ~line 166)\n- Test: tests/test_server.py\n\n**Function signature:**\n```python\ndef _correct_extension(save_path: Path, actual_format: ImageFormat) -\u003e tuple[Path, str | None]:\n```\n\n**Logic:**\n- JPEG accepts .jpg and .jpeg\n- No extension → append correct one\n- Mismatch → correct and return warning\n- Match → return path unchanged, None warning\n\n**Test cases:**\n- .jpg/.jpeg for JPEG → no correction\n- .png for PNG → no correction\n- .json for JPEG → correct to .jpg\n- .png for JPEG → correct to .jpg\n- .JSON (uppercase) → normalize and correct\n- no extension → append .jpg or .png\n\n**Warning format:** 'Gemini returned {FORMAT} image; saved as {new_ext} (requested {old_ext})'\n\n**TDD:** Write tests first, implement, commit.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-10T15:06:23.810838-08:00","updated_at":"2025-12-10T15:47:28.581384-08:00","closed_at":"2025-12-10T15:47:28.581384-08:00"}
{"id":"banana-appeal-wjl","title":"Investigate additional Gemini response metadata","description":"Check what additional metadata is available from Gemini API responses that we could expose:\n\n- usage_metadata (token counts)\n- C2PA signature details  \n- Model version info\n- Any other response fields we're not capturing\n\nAdd valuable fields to the structured response.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-10T14:41:11.340544-08:00","updated_at":"2025-12-10T14:41:11.340544-08:00"}
{"id":"banana-appeal-wz3","title":"Add resolution parameter to generate_image","description":"Gemini supports 1K, 2K, and 4K output resolutions via ImageConfig.image_size. Add an optional resolution parameter (defaulting to 1K) to allow users to request higher quality outputs when needed. Note: resolution values must be uppercase (1K not 1k).","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-06T15:29:47.894966-08:00","updated_at":"2025-12-07T11:55:19.419022-08:00","closed_at":"2025-12-07T11:55:19.419022-08:00"}
{"id":"banana-appeal-xan","title":"Extract shared prompt/path validators in models.py","description":"Three request models (GenerateImageRequest, EditImageRequest, BlendImagesRequest) have identical validators for: prompt whitespace validation, str|Path to Path conversion, file existence checks. Extract to shared validator functions. Estimated reduction: ~24 lines.","status":"open","priority":4,"issue_type":"chore","created_at":"2025-12-15T10:56:53.923366-08:00","updated_at":"2025-12-15T10:56:53.923366-08:00"}
{"id":"banana-appeal-xd9","title":"Update blend_images with structured response","description":"Modify blend_images to return structured response when saving.\n\n**Files:**\n- Modify: src/banana_appeal/server.py\n- Test: tests/test_server.py\n\n**Changes to _blend_images_impl:**\n- Add verbose: bool = False parameter\n- Track generation_time_ms\n- Call _correct_extension before saving\n- Return ImageOperationResponse for saved, ImageResult for inline\n- Call _add_verbose_fields if verbose=True\n\n**Changes to blend_images MCP wrapper:**\n- Add verbose parameter\n- Call result.model_dump(exclude_none=True) for structured response\n\n**Tests:**\n- test_returns_dict_when_saving\n- test_returns_image_result_without_output_path\n- test_verbose_mode\n\n**TDD:** Write tests first, implement, commit.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-10T15:06:24.6222-08:00","updated_at":"2025-12-10T16:36:17.058706-08:00","closed_at":"2025-12-10T16:36:17.058706-08:00","dependencies":[{"issue_id":"banana-appeal-xd9","depends_on_id":"banana-appeal-vnj","type":"blocks","created_at":"2025-12-10T15:06:43.235299-08:00","created_by":"daemon"},{"issue_id":"banana-appeal-xd9","depends_on_id":"banana-appeal-tfs","type":"blocks","created_at":"2025-12-10T15:06:43.264189-08:00","created_by":"daemon"}]}
{"id":"banana-appeal-zxx","title":"Add ImageOperationResponse model","description":"Add ImageOperationResponse Pydantic model for structured responses.\n\n**Files:**\n- Modify: src/banana_appeal/models.py (add after ImageDimensions)\n- Test: tests/test_models.py\n\n**Model fields:**\n- path: str | None (where image was saved)\n- format: str (jpeg, png, etc.)\n- warnings: list[str] (any corrections)\n- original_path: str | None (if extension corrected)\n- dimensions: ImageDimensions | None (verbose)\n- size_bytes: int | None (verbose)\n- generation_time_ms: float | None (verbose)\n- model: str | None (verbose)\n- seed: int | None (verbose)\n\n**Tests:**\n- test_minimal_response\n- test_response_with_path\n- test_response_with_correction\n- test_verbose_response\n- test_to_dict (exclude_none=True)\n\n**TDD:** Write tests first, implement, commit.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-10T15:06:23.615978-08:00","updated_at":"2025-12-10T15:28:37.711249-08:00","closed_at":"2025-12-10T15:28:37.711249-08:00","dependencies":[{"issue_id":"banana-appeal-zxx","depends_on_id":"banana-appeal-8d9","type":"blocks","created_at":"2025-12-10T15:06:42.481634-08:00","created_by":"daemon"}]}
